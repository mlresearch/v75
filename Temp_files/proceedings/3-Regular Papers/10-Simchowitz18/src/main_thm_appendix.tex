%!TEX root = LWM.tex
\section{Proof of Theorem~\ref{main_thm} \label{app:main_thm}}
In this section, we conclude the technical aspects of the proof of Theorem~\ref{main_thm}. Recall the definition of the events
\begin{align*}
  \calE_1 := \left\{ \opnorm{\matU^{\top} \Noise} \geq K \right\} \:, \quad \calE_2 := \left\{\matX^\top\matX \succeq \frac{k\lfloor T/k\rfloor p^2 \Gamsb }{16}\right\} \:, \quad \calE_3 := \left\{ \matX^\top\matX \npreceq \Gambar \right\} \:.
\end{align*}
As we recall from Section~\ref{sec:mn_thm_proof}, if we can show that $\Pr[ \calE_2^c \cap \calE_3^c]$ and $\Pr\left[ \calE_1 \cap \calE_2 \cap \calE_3^c \right]$ where bounded above by $\delta$, we have
\begin{eqnarray}
 \Pr \left[\opnorm{\matX^{\dagger} \Noise} \geq \frac{4K}{p\sqrt{k\floor{T/k}\lambda_{\min}(\Gamsb) }} \right] \le 3\delta
\end{eqnarray}
Observe that our condition on $k$ implies that necessarily $k \le T/10~$, so that $k\floor{T/k} \ge T - k \ge 9/10T$. Hence, we will have established
\begin{eqnarray}
 \Pr \left[\opnorm{\matX^{\dagger} \Noise} \geq \frac{10}{9} \cdot \frac{4K}{p\sqrt{T\lambda_{\min}(\Gamsb) }}  \right] \le 3\delta~,
\end{eqnarray}
and substiting in 
\begin{eqnarray}
K =  20\sigma \sqrt{n + d\log \frac{10}{p} + \log \det(\Gambar\Gamsb^{-1}) + \log(1/\delta) }~.
\end{eqnarray}
proves the theorem. 

\subsection{Bounding $\Pr[ \calE_2^c \cap \calE_3^c]$ \label{app:main_sigm_min}}

Substituting the definitions of $\calE_2$ and $\calE_3$,
\begin{eqnarray*}
\Pr[ \calE_2^c \cap \calE_3^c]= \Pr\left[\left\{ \matX^\top\matX \nsucceq \frac{k\lfloor T/k\rfloor p^2 \nu^2 }{16}\right\} \cap \{\matX^\top\matX \preceq \Gamax\}\right]~.
\end{eqnarray*}
%

Proposition~\ref{prop:Small_Ball} and Equation~\eqref{eq:main_thm_condition} imply
\begin{eqnarray}\label{eq:one_w}
\forall \direc \in \R^{d},~\Pr\left[ \|\matX \direc\|^2 \le \frac{k\lfloor T/k\rfloor p^2 \direc^\top \Gamsb \direc }{8}\right] \le \exp\left( - \frac{\floor{T/k}p^2}{8}\right) %\le \frac{\delta}{3} \cdot \left(1+\frac{128 \itlamax}{T p^2 \nu^2}\right)^{-d}.
\end{eqnarray}
We apply Lemma~\ref{lem:eig_Packing_Lem} with $Q =  \matX$, with $\Gamax \leftarrow T\Gambar$, $\Gamin \leftarrow k \floor{T/k} p^2 \Gamsb/8$, and $\calT$ a net $1/4$-net of $\sphereGamin$ in the norm $\normGamax$. We shall use the following estimate of $|\calT|$:
\begin{lem}\label{lem:covering_number} Let $0 \prec \Gamin \preceq \Gamax$, and let $\calT$ be a minimal $\epsilon \le 1/2$-net of $\sphereGamin$ in the norm $\normGamax$. Then, $\log |\calT| \le d\log(1+\frac{2}{\epsilon}) + \log \det (\Gamax \Gamin^{-1})$. 
\end{lem}
\begin{proof} The covering number of $\sphereGamin$ in the norm $\normGamax$ is the same as the covering number of the shell of the ellipsoid $E := \{\direc: \direc^{\top} \Gamin^{-1/2}\Gamax \Gamin^{-1/2}\direc\}$ in the norm $\|(\cdot)\|_2$. Consider a maximal $\epsilon$-separated set of $\mathrm{bd}(E)$. Letting $\calB$ denote the unit ball in $\R^d$, a standard volumetric argument shows 
\begin{eqnarray*}
|\calT| &\le& \frac{\vol(\frac{2}{\epsilon}\calB + E)}{\vol(\frac{2}{\epsilon})} \\
&\overset{(i)}{\le}& \frac{\vol((\frac{2}{\epsilon}+1)E)}{\vol(\calB)} = \left(\frac{2}{\epsilon}+1\right)^d\frac{\vol(E)}{\vol(\calB)} \\
&=& \left(\frac{2}{\epsilon}+1\right)^d \det(\Gamin^{-1/2}\Gamax \Gamin^{-1/2})\\
&=& \left(\frac{2}{\epsilon}+1\right)^d \det(\Gamax \Gamin^{-1})\\
\end{eqnarray*}
where $(i)$ uses the inclusion $\calE \subset \calE$. 
\end{proof}
For $\epsilon = 1/4$ and our choise of $\Gamin$, we have
\begin{eqnarray}
\log |\calT| &=& d\log(1+\frac{2}{\epsilon}) + \log \det (\Gamax \Gamin^{-1})\\
&=& d\log(9) + d \log (8T/(\floor{T/k}k) p^2) +  \log \det (\Gambar \Gamsb^{-1})\nonumber\\
&\le& d\log(9) + d \log (72/ 10p^2) +  \log \det (\Gambar \Gamsb^{-1})~\quad \text{ since } k \le T/2\nonumber\\
&\le& 2d\log(10/ p) +  \log \det (\Gambar \Gamsb^{-1})~ \label{eq:calt_bound}.
\end{eqnarray}
Hence, we conclude that
\begin{eqnarray*}
&&\Pr[ \calE_2^c \cap \calE_3^c]= \Pr\left[\left\{ \matX^\top\matX \nsucceq \frac{k\lfloor T/k\rfloor p^2 \nu^2 }{16}\right\} \cap \{\matX^\top\matX \preceq \Gamax\}\right] \\
&\le& \Pr\left[ \left\{\exists \direc \in \calT : \|\matX \direc\|^2 < \frac{k\floor{T/k}T p^2 \direc^\top\Gamsb \direc }{8}\right\} \cap \{\matX^\top\matX \preceq \Gamax\}\right] \\
&\le&  \exp\left( - \frac{\floor{T/k}p^2}{8}+ 2d\log(10/ p) +  \log \det (\Gambar \Gamsb^{-1}) \right)\\
&\le&  \exp\left( - \frac{Tp^2}{10k} + 2d\log(10/ p) +  \log \det (\Gambar \Gamsb^{-1})\right)
\end{eqnarray*}

\subsection{Bounding $\Pr\left[ \calE_1 \cap \calE_2 \cap \calE_3^c \right]\label{app:main_noise}$}
We shall need the following discretization lemma, proved in Appendix~\ref{sec:proof_lem_lin_pack}:
\begin{lem}\label{lem:Lin_packing} Let $Q \in \R^{n\times m}$ have full column rank,
$q \in \R^n$, let $0 \prec \Gamin \preceq Q^TQ \preceq \Gamax$, and let $\calT$ be a $1/4$-net of $\sphereGamin$ in the norm $\normGamax$.
Then, 
\begin{eqnarray}\sup_{\direc \in \calS^{m-1}} \frac{ \langle Q \direc,  q \rangle}{\|Q \direc\|} \le 2\max_{\direc \in \calT}  \frac{ \langle Q \direc, q \rangle}{\|Q \direc\|}
\end{eqnarray}
\end{lem}

To control the size of $\opnorm{\matU^\top \Noise}$ we use a variational formulation of the operator norm and two coverings. Lett $\R_*^d := \R^d - \{0\}$. Note that if $\calT_1$ is a $1/2$-net of $\calS^{n-1}$ (over the $v)$, then, 
\begin{eqnarray*}
\opnorm{\matU^\top \Noise} &\le&  \sup_{v \in \calS^{n-1}, \direc \in \R_*^{d}} \frac{\direc^{\top}\matU^{\top} \Noise v}{\|\direc\|} \\
\ &\le&  2\max_{v \in \calT_1}\left(\sup_{\direc \in \R_*^{d}} \frac{\direc^{\top}\matU^{\top} \Noise v }{\|\direc\|}  \right)\quad \text{ since } \calT_1  \text{ is a } 1/2 \text{-net} \\
&=&  2\max_{v \in \calT_1} \left(\sup_{\direc \in \R_*^{d}} \frac{\direc^{\top}\matV\matSig\matU^{\top} \Noise v }{\| \matSig \matV^\top \direc\|} \right) \quad \text{ since }\matSig\matV^{\top} \text{ is full rank on } \calE_2\\
&=& 2 \max_{v \in \calT_1}\left(\sup_{\direc \in \R_*^{d}} \frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|}\right) = 2 \max_{v \in \calT_1}\left(\sup_{\direc \in \calS^{d-1}} \frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|}\right),
\end{eqnarray*}
where the second-to-last equation uses $\matX = \matU \matSig \matV^{\top}$ and $\|\matSig \matV^\top \direc\| = \|\matU \matSig \matV^\top \direc\| = \|\matX \direc\|$. Define $\calE_g := \calE_2 \cap \calE_3^c$. We see then that on $\calE_g$, we have 
\begin{eqnarray*}
\frac{k\lfloor T/k\rfloor p^2 \Gamsb^2 }{16} \preceq \matX^\top\matX \preceq T\Gamax~.
\end{eqnarray*}
We now apply Lemma~\ref{lem:Lin_packing} with $Q =  \matX$, with 
\begin{eqnarray}\label{Gam:def}
\Gamax \leftarrow T\Gambar & \text{and } & \Gamin \leftarrow k \floor{T/k} p^2 \Gamsb/16
\end{eqnarray}
and $\calT_2$ a net $1/4$-net of $\sphereGamin$ in the norm $\normGamax$. This yields
\begin{eqnarray*}
&&\Pr\left[\left\{\opnorm{\matU^\top \Noise} > K\right\} \cap \calE_g\right] \\
&\le& \Pr\left[\left\{\max_{v \in \calT_1} \sup_{\direc \in \calS^{d-1}}\frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|} > K/2\right\} \cap \calE_g\right] \\
&\le& \Pr\left[\left\{\max_{v \in \calT_1} \max_{\direc \in \calT_2}\frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|} > K/4\right\} \cap \calE_g\right] \\
&\le& |\calT_1||\calT_2|\sup_{v \in \calT_1,\direc \in \calT_2} \Pr\left[\left\{\frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|} > K/4\right\} \cap \calE_g\right] \:.
\end{eqnarray*}
To obtain a pointwise bound on $\Pr\left[\left\{\frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|} > K/4\right\} \cap \calE_g\right]$ we use Lemma~\ref{lem:martingale_lem}, with $Z_t = \langle X_t, \direc \rangle$, 
$\noiseb_t = \langle \noise_t, v \rangle$, and the bounds $\beta_- = \direc^\top \Gamin \direc$, and $\beta_+ = \direc^\top \Gamax \direc$, $\Gamin$, $\Gamax$ are as in Equation~\eqref{Gam:def}. We can then bound
\begin{eqnarray*}
&&|\calT_1||\calT_2|\sup_{v \in \calS^{d-1},\direc \in \calS^{d-1}}\Pr\left[\left\{\frac{\direc^{\top}\matX^{\top} \Noise v }{\|\matX \direc\|} > K/4\right\} \cap \calE_g\right] \\
&\le& |\calT_1||\calT_2|\sup_{v \in \calS^{d-1},\direc \in \calS^{d-1}}\Pr\left[\left\{\frac{\direc^\top \matX^\top \Noise v}{\|\matX \direc\|} > K/4\right\} \cap \left\{ \|\matX \direc\|^2 \in \left[\frac{k\floor{T/k} \nu^2 p^2}{16},\itlamax \right]\right\}\right] \\
&\le& |\calT_1||\calT_2| \log_+ \ceil{\frac{\beta_+}{\beta_-}} \exp(-K^2 / 96 \sigma^2 )\\
&\overset{(i)}{\le}& \exp( n \log 5 + d\log 9 + \log \det(\frac{32}{p^2}\Gamax\Gamin^{-1}))  \log_+ \ceil{\frac{\beta_+}{\beta_-}} \exp(-K^2 / 96\sigma^2 ) \:.
\end{eqnarray*}
where $(i)$ uses the standard metric entropy bound for the sphere(see, e.g.~\cite{vershynin11}), and an analogous computation to~\eqref{eq:calt_bound}.
Now since $\direc \ne 0$, bound $\log \ceil{x} \le \log 1 + x \le x$, and computing as in~\eqref{eq:calt_bound} yields the bound
\begin{eqnarray*}
\log\ceil{\frac{\beta_+}{\beta_-}} ~\le~\frac{\beta_+}{\beta_-} &\le&  \sup_{\direc \in \R^d - \{0\}} \frac{\direc^\top \Gamax \direc}{\direc^\top \Gamin \direc} \\
&=& \|\Gamin^{-1/2}\Gamax\Gamin^{-1/2}\| = \lambda_{\max}(\Gamax \Gamin^{-1})\\
&=& \lambda_{\max}(\frac{32}{p^2}\Gambar\Gamsb^{-1}))\\
&\le& \exp( \log \lambda_{\max}(\frac{32}{p^2}\Gambar\Gamsb^{-1}))~)\\
&\overset{(i)}{=}& \exp( \log \det(\frac{32}{p^2}\Gambar\Gamsb^{-1})))~.
\end{eqnarray*}
where $(i)$ uses the fact that $\frac{32}{p^2}\Gambar\Gamsb^{-1}$ has the same eigenvalues as $\frac{32}{p^2}\Gamsb^{-1/2}\Gambar\Gamsb^{-1/2} \succeq \frac{32}{p^2} \succeq I$.  All together, we have
\begin{eqnarray*}
&&\Pr\left[\left\{\opnorm{\matU^\top \Noise} > K\right\} \cap \calE_g\right]\\ &\le& \exp( n \log 5 + d\log 9 + 2\log \det(\frac{32}{p^2}\Gambar\Gamsb^{-1}))\exp(-K^2 / 96\sigma^2 ) \\
&\le& \exp( n \log 5 + 2d\log \frac{96}{p^2} + 2\log \det(\Gambar\Gamsb^{-1}))\exp(-K^2 / 96\sigma^2 ) \\
&\le& \exp( 4(n + d\log \frac{10}{p} + \log \det(\Gambar\Gamsb^{-1})))\exp(- (K/10\sigma)^2) 
\end{eqnarray*}
Hence, we guarantee that $\Pr\left[ \calE_1 \cap \calE_2 \cap \calE_3^c \right] \leq \delta $ if we choose
\begin{eqnarray*}
K = 20\sigma \sqrt{n \log  + d\log \frac{10}{p} + \log \det(\Gambar\Gamsb^{-1}) + \log(1/\delta) }~.
\end{eqnarray*}

